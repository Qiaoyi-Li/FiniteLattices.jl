<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>FiniteLattices.jl · FiniteLattices.jl</title><meta name="title" content="FiniteLattices.jl · FiniteLattices.jl"/><meta property="og:title" content="FiniteLattices.jl · FiniteLattices.jl"/><meta property="twitter:title" content="FiniteLattices.jl · FiniteLattices.jl"/><meta name="description" content="Documentation for FiniteLattices.jl."/><meta property="og:description" content="Documentation for FiniteLattices.jl."/><meta property="twitter:description" content="Documentation for FiniteLattices.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>FiniteLattices.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>FiniteLattices.jl</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Lattices"><span>Lattices</span></a></li><li><a class="tocitem" href="#Methods"><span>Methods</span></a></li><li><a class="tocitem" href="#FT"><span>FT</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>FiniteLattices.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>FiniteLattices.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="FiniteLattices.jl"><a class="docs-heading-anchor" href="#FiniteLattices.jl">FiniteLattices.jl</a><a id="FiniteLattices.jl-1"></a><a class="docs-heading-anchor-permalink" href="#FiniteLattices.jl" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#FiniteLattices.jl">FiniteLattices.jl</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Lattices">Lattices</a></li><li><a href="#Methods">Methods</a></li><li><a href="#FT">FT</a></li></ul></li></ul><h2 id="Lattices"><a class="docs-heading-anchor" href="#Lattices">Lattices</a><a id="Lattices-1"></a><a class="docs-heading-anchor-permalink" href="#Lattices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.AbstractLattice" href="#FiniteLattices.AbstractLattice"><code>FiniteLattices.AbstractLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> abstract type AbstractLattice</code></pre><p>Abstract supertype of all lattices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.EmbeddedLattice" href="#FiniteLattices.EmbeddedLattice"><code>FiniteLattices.EmbeddedLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> abstract type EmbeddedLattice{D} &lt;: AbstractLattice</code></pre><p>Abstract type of those lattices can be embedded into an Euclidean space <code>ℝ^D</code>. Therefore each point in the lattice has a coordinate, and the distance between two points is induced by the Euclidean metric. </p><p><strong>Interfaces should be implemented</strong></p><pre><code class="nohighlight hljs"> size(Latt::EmbeddedLattice) -&gt; ::Int64</code></pre><p>Return the size of the lattice, i.e. the number of sites.</p><pre><code class="nohighlight hljs"> coordinate(Latt::EmbeddedLattice{D}, idx) -&gt; ::NTuple{D, Float64}</code></pre><p>Return the coordinate of a given site.</p><pre><code class="nohighlight hljs"> equiVec(Latt::EmbeddedLattice{D}) -&gt; ::Vector{NTuple{D,Float64}}</code></pre><p>Return the equivalent vectors around the origin point due to the boundary condition. For example, for a square lattice on a torus, there are 9 equivalent vectors <code>(0.0, 0.0), (0.0, ±1.0), (±1.0, 0.0), (±1.0, ±1.0)</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L10-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.NonEmbeddedLattice" href="#FiniteLattices.NonEmbeddedLattice"><code>FiniteLattices.NonEmbeddedLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> abstract type NonEmbeddedLattice &lt;: AbstractLattice</code></pre><p>Abstract type of those lattices <code>cannot</code> be embedded into an Euclidean space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.SimpleLattice" href="#FiniteLattices.SimpleLattice"><code>FiniteLattices.SimpleLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> abstract type SimpleLattice{D, T&lt;:AbstractBoundaryCondition} &lt;: EmbeddedLattice{D}</code></pre><p>Abstract type of <code>D</code>-dimensional simple lattices. </p><p><strong>Fields must be implemented</strong></p><pre><code class="nohighlight hljs"> e::NTuple{D, NTuple{D, Float64}}</code></pre><p>Primitive vectors <code>(e₁, e₂, ...)</code>.</p><pre><code class="nohighlight hljs"> sites::Vector{NTuple{D, Int64}}</code></pre><p>Sites of the finite lattice, each site is represented by the coefficients of primitive vectors. For example, site <code>(a, b)</code> has coordinate <code>a*e₁ + b*e₂</code>.</p><pre><code class="nohighlight hljs"> BC::AbstractBoundaryCondition</code></pre><p>Boundary condition, used when computing the distance between two sites.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/SimpleLattice.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.CompositeLattice" href="#FiniteLattices.CompositeLattice"><code>FiniteLattices.CompositeLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct CompositeLattice{D, N, T} &lt;: EmbeddedLattice{D}
      subLatts::T
      shift::NTuple{N, NTuple{D, Float64}}
      sites::Vector{NTuple{2, Int64}}
 end</code></pre><p>Wrapper type of composite lattices.</p><p><strong>Fields</strong></p><pre><code class="nohighlight hljs"> subLatts::NTuple{N, SimpleLattice}</code></pre><p>List of the sublattices of the composite lattice.</p><pre><code class="nohighlight hljs"> shift::NTuple{N, NTuple{D, Float64}}</code></pre><p>Shift of each sublattice, used when computing the coordinates.</p><pre><code class="nohighlight hljs"> sites::Vector{NTuple{2, Int64}}</code></pre><p>Lazily collect the sites. The first index denotes the sublattice and the second index denotes the site in it.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs"> CompositeLattice{D}(subLatts::NTuple{N, SimpleLattice},
      shift::NTuple{N, NTuple{D, Float64}} = Tuple(fill(Tuple(zeros(D)), N)))</code></pre><p>Finally used constructor. Generating a higher dimensional lattice is supported by given a larger <code>D</code> manually.</p><pre><code class="nohighlight hljs"> CompositeLattice(subLatts::NTuple{N, SimpleLattice{D}},
      shift::NTuple{N, NTuple{D, Float64}} = Tuple(fill(Tuple(zeros(D)), N))) 
 CompositeLattice(Latt1, Latt2, ..., shift)</code></pre><p>Deduce <code>D</code> from the sublattices or <code>shift</code>. Each sublattice must have the same dimension in this usage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/CompositeLattice.jl#L1-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.AbstractBoundaryCondition" href="#FiniteLattices.AbstractBoundaryCondition"><code>FiniteLattices.AbstractBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> abstract type AbstractBoundaryCondition</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/BC.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.OpenBoundaryCondition" href="#FiniteLattices.OpenBoundaryCondition"><code>FiniteLattices.OpenBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct OpenBoundaryCondition &lt;: AbstractBoundaryCondition</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/BC.jl#L6-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.PeriodicBoundaryCondition" href="#FiniteLattices.PeriodicBoundaryCondition"><code>FiniteLattices.PeriodicBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct PeriodicBoundaryCondition{D} &lt;: AbstractBoundaryCondition 
      V::NTuple{D,Int64}
 end</code></pre><p>Periodic boundary condition in <code>D</code> dimensions. <code>V</code> denotes the vector of the periodicity. For example, <code>V = (0, W)</code> means the site <code>(a, b)</code> is equivalent to <code>(a, b+W)</code> and thus forms a YC boundary condition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/BC.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.TwistBoundaryCondition" href="#FiniteLattices.TwistBoundaryCondition"><code>FiniteLattices.TwistBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct TwistBoundaryCondition{D} &lt;: AbstractBoundaryCondition 
      V::NTuple{D,Int64}
      θ::Float64
 end</code></pre><p>Twist boundary condition in <code>D</code> dimensions. <code>V</code> denotes the vector of the periodicity. <code>θ ∈ (0, 2π)</code> is the twist angle, means <code>c_{r+V} = e^{-iθ}c_{r}</code>. Note <code>θ = 0</code> results in a periodic boundary condition and thus is not allowed. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/BC.jl#L25-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.CompositeBoundaryCondition" href="#FiniteLattices.CompositeBoundaryCondition"><code>FiniteLattices.CompositeBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct CompositeBoundaryCondition{N, T} &lt;: AbstractBoundaryCondition
      BC::T
 end</code></pre><p>Wrapper of multiple boundary conditions. <code>BC</code> is a tuple of boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/BC.jl#L42-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.SquareLattice" href="#FiniteLattices.SquareLattice"><code>FiniteLattices.SquareLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct SquareLattice{D,T&lt;:AbstractBoundaryCondition} &lt;: SimpleLattice{D, T}
      e::NTuple{D,NTuple{D,Float64}}
      sites::Vector{NTuple{D,Int64}}
      BC::T
 end</code></pre><p>Concrete type of D-dimensional square lattices. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/SquaLatt.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.OpenSqua" href="#FiniteLattices.OpenSqua"><code>FiniteLattices.OpenSqua</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> OpenSqua(L::Int64, W::Int64) -&gt; ::SquareLattice</code></pre><p>Construct an open <code>L × W</code> square lattice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/SquaLatt.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.YCSqua" href="#FiniteLattices.YCSqua"><code>FiniteLattices.YCSqua</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> YCSqua(L::Int64, W::Int64, θ::Real = 0.0) -&gt; ::SquareLattice</code></pre><p>Construct a YC <code>L × W</code> square lattice, where <code>θ</code> is the twist angle, e.g. <code>θ = 0</code> means PBC and <code>θ = π</code> means APBC.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/SquaLatt.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.TriangularLattice" href="#FiniteLattices.TriangularLattice"><code>FiniteLattices.TriangularLattice</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> struct TriangularLattice{D, T&lt;:AbstractBoundaryCondition} &lt;: SimpleLattice{D, T}
      e::NTuple{D,NTuple{D,Float64}}
      sites::Vector{NTuple{D,Int64}}
      BC::T
 end</code></pre><p>Concrete type of triangular lattices. Note we only assume each layer is a triangular lattice if <code>D &gt; 2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/TriaLatt.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.YCTria" href="#FiniteLattices.YCTria"><code>FiniteLattices.YCTria</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> YCTria(L::Int64, W::Int64, θ::Real = 0.0;
      reflect::Bool = false,
      scale::Real = 1.0) -&gt; ::TriangularLattice</code></pre><p>Construct a YC <code>L × W</code> triangular lattice, where <code>θ</code> is the twist angle, e.g. <code>θ = 0</code> means PBC and <code>θ = π</code> means APBC.</p><p><strong>kwargs</strong></p><pre><code class="nohighlight hljs"> reflect::Bool = false</code></pre><p>If <code>reflect = true</code>, reflect the lattice along the <code>x</code> axis from the default convention.</p><pre><code class="nohighlight hljs"> scale::Real = 1.0</code></pre><p>The scale factor of the lattice. <code>scale = 1.0</code> means the length of the primitive vectors equals to <code>1.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/TriaLatt.jl#L35-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.XCTria" href="#FiniteLattices.XCTria"><code>FiniteLattices.XCTria</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> XCTria(L::Int64, W::Int64,  θ::Real = 0.0;
      reflect::Bool = false,
      scale::Real = 1.0) -&gt; ::TriangularLattice</code></pre><p>Construct a XC <code>L × W</code> triangular lattice, where <code>θ</code> is the twist angle, e.g. <code>θ = 0</code> means PBC and <code>θ = π</code> means APBC. </p><p><strong>kwargs</strong></p><pre><code class="nohighlight hljs"> reflect::Bool = false</code></pre><p>If <code>reflect = true</code>, reflect the lattice along the <code>y</code> axis from the default convention.</p><pre><code class="nohighlight hljs"> scale::Real = 1.0</code></pre><p>The scale factor of the lattice. <code>scale = 1.0</code> means the length of the primitive vectors equals to <code>1.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/TriaLatt.jl#L68-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.OHTria" href="#FiniteLattices.OHTria"><code>FiniteLattices.OHTria</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> OHTria(L::Int64) -&gt; ::TriangularLattice</code></pre><p>Construct a triangular lattice in an open hexagon with <code>L</code> sites in a side.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/TriaLatt.jl#L100-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.YCHoneycomb" href="#FiniteLattices.YCHoneycomb"><code>FiniteLattices.YCHoneycomb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> YCHoneycomb(L::Int64, W::Int64, θ::Real = 0.0; scale::Real = 1.0) -&gt; ::CompositeLattice</code></pre><p>Construct a YC <code>L × W</code> honeycomb lattice, where <code>θ</code> is the twist angle. Note YC honeycomb lattice is a XC triangular lattice with 2 sites per unit cell.</p><p><strong>kwargs</strong></p><pre><code class="nohighlight hljs"> scale::Real = 1.0</code></pre><p>The scale factor of the lattice, which equals to the distance between the nearest neighbor unit cells. Thus, use <code>scale = sqrt(3)</code> to make the length of the NN bond equals to <code>1.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/HoneycombLatt.jl#L26-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.XCHoneycomb" href="#FiniteLattices.XCHoneycomb"><code>FiniteLattices.XCHoneycomb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> XCHoneycomb(L::Int64, W::Int64, θ::Real = 0.0; kwargs...) -&gt; ::CompositeLattice</code></pre><p>Construct a XC <code>L × W</code> honeycomb lattice, where <code>θ</code> is the twist angle. Note XC honeycomb lattice is a YC triangular lattice with 2 sites per unit cell. </p><p><strong>kwargs</strong></p><pre><code class="nohighlight hljs"> scale::Real = 1.0</code></pre><p>The scale factor of the lattice, which equals to the distance between the nearest neighbor unit cells. Thus, use <code>scale = sqrt(3)</code> to make the length of the NN bond equals to <code>1.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/HoneycombLatt.jl#L1-L9">source</a></section></article><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.coordinate" href="#FiniteLattices.coordinate"><code>FiniteLattices.coordinate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> coordinate(Latt::EmbeddedLattice{D}, idx) -&gt; ::NTuple{D, Float64}</code></pre><p>Return the coordinate of a given site.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L27-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.distance" href="#FiniteLattices.distance"><code>FiniteLattices.distance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> distance(Latt::EmbeddedLattice, idx1::Ind64, idx2::Int64) -&gt; ::Float64</code></pre><p>Return the distance between two sites.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L39-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.Zigzag!" href="#FiniteLattices.Zigzag!"><code>FiniteLattices.Zigzag!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> Zigzag!(Latt::EmbeddedLattice) -&gt; Latt</code></pre><p>Sort sites according to zigzag path, i.e. lexicographic order where last dimension first. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/Path.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.Snake!" href="#FiniteLattices.Snake!"><code>FiniteLattices.Snake!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> Snake!(Latt::SimpleLattice{2}) -&gt; Latt</code></pre><p>Sort sites according to snake path, i.e. lexicographic order up to an even-odd modulation. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/Path.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.neighbor" href="#FiniteLattices.neighbor"><code>FiniteLattices.neighbor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> neighbor(Latt::EmbeddedLattice, i::Int64; kwargs...) -&gt; ::Vector{Int64}</code></pre><p>Return all the neighbor sites of a given site.</p><pre><code class="nohighlight hljs"> neighbor(Latt::EmbeddedLattice; kwargs...) -&gt; ::Vector{NTuple{2, Int64}}</code></pre><p>Return all neighbor pairs of a given lattice.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> d::Union{Missing, Real} = missing</code></pre><p>The distance between the two sites of the neighbor pair.</p><pre><code class="nohighlight hljs"> level::Int64 = 1</code></pre><p>The neighbor level, e.g. <code>level = 1</code> means the nearest neighbor, <code>level = 2</code> means the next nearest neighbor, etc. Note it is defined by the total lattice, instead of the given site <code>i</code>. Note the priority is <code>d &gt; level</code>.</p><pre><code class="nohighlight hljs"> ordered::Bool = false</code></pre><p>View <code>(i,j)</code> as an ordered pair if <code>true</code>, i.e. <code>(i,j) ≠ (j,i)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/neighbor.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.equiVec" href="#FiniteLattices.equiVec"><code>FiniteLattices.equiVec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> equiVec(Latt::EmbeddedLattice{D}) -&gt; ::Vector{NTuple{D,Float64}}</code></pre><p>Return the equivalent vectors around the origin point due to the boundary condition. For example, for a square lattice on a torus, there are 9 equivalent vectors <code>(0.0, 0.0), (0.0, ±1.0), (±1.0, 0.0), (±1.0, ±1.0)</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L33-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.relaVec" href="#FiniteLattices.relaVec"><code>FiniteLattices.relaVec</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> relaVec(Latt::EmbeddedLattice, idx1::Int64, idx2::Int64) -&gt; ::NTuple{D, Float64}</code></pre><p>Return the nearest relative vector between the two sites. Note PBC is considered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/AbstractLattice.jl#L49-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.intrapair" href="#FiniteLattices.intrapair"><code>FiniteLattices.intrapair</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> intrapair(Latt::CompositeLattice, idx::Int64; kwargs...) -&gt; ::Vector{NTuple{2, Int64}}</code></pre><p>Similar to <code>neighbor</code>, but only return the intra-sublattice pairs of the <code>idx</code> sublattice.</p><pre><code class="nohighlight hljs"> intrapair(Latt::CompositeLattice,
      lsidx::AbstractVector{Int64} = 1:N;
      kwargs...) -&gt; ::Vector{NTuple{2, Int64}}</code></pre><p>Collect all the intra-sublattice pairs of the given sublattices.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> d::Union{Missing, Real} = missing</code></pre><p>The distance between the two sites of the neighbor pair.</p><pre><code class="nohighlight hljs"> level::Int64 = 1</code></pre><p>The neighbor level, note the inter-sublattice pairs will be ignored when calculating the distance with given <code>level</code>.</p><pre><code class="nohighlight hljs"> ordered::Bool = false</code></pre><p>View <code>(i,j)</code> as an ordered pair if <code>true</code>, i.e. <code>(i,j) ≠ (j,i)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/CompositeLattice.jl#L116-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.interpair" href="#FiniteLattices.interpair"><code>FiniteLattices.interpair</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> interpair(Latt::CompositeLattice; kwargs...) -&gt; ::Vector{NTuple{2, Int64}}</code></pre><p>Collect all the inter-sublattice pairs.</p><pre><code class="nohighlight hljs"> interpair(Latt::CompositeLattice, idx1::Int64, idx2::Int64;
      kwargs...) -&gt; ::Vector{NTuple{2, Int64}}</code></pre><p>Similar to <code>neighbor</code>, but only return the inter-sublattice pairs <code>(i, j)</code> s.t. <code>i</code> in <code>idx1</code> and <code>j</code> in <code>idx2</code> sublattices. Note the kwarg <code>ordered</code> will not affect the result for this usage.</p><p><strong>Kwargs</strong></p><pre><code class="nohighlight hljs"> d::Union{Missing, Real} = missing</code></pre><p>The distance between the two sites of the neighbor pair.</p><pre><code class="nohighlight hljs"> level::Int64 = 1</code></pre><p>The neighbor level, note the intra-sublattice pairs will be ignored when calculating the distance with given <code>level</code>.</p><pre><code class="nohighlight hljs"> ordered::Bool = false</code></pre><p>View <code>(i,j)</code> as an ordered pair if <code>true</code>, i.e. <code>(i,j) ≠ (j,i)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/Lattice/CompositeLattice.jl#L176-L193">source</a></section></article><h2 id="FT"><a class="docs-heading-anchor" href="#FT">FT</a><a id="FT-1"></a><a class="docs-heading-anchor-permalink" href="#FT" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.FTCoefs" href="#FiniteLattices.FTCoefs"><code>FiniteLattices.FTCoefs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> FTCoefs(Latt::EmbeddedLattice{D}, k::NTuple{D,Float64}; kwargs...) -&gt; ::Vector{ComplexF64}
 FTCoefs(Latt::EmbeddedLattice{D}, lsk::AbstractVector{NTuple{D,Float64}}; kwargs...) -&gt; ::Matrix{ComplexF64}</code></pre><p>Return the Fourier coefficients corresponding to the given wave vector <code>k</code>, represented by a length <code>N</code> vector where <code>N</code> is the number of sites in the lattice. Note the FT convention is <code>FS(k) = 1/sqrt(N) ∑_r exp(-ik⋅r) S(r)</code>.</p><p>Note our convention guarantees the FT is orthogonal thus the returned vector is normalized. However, the returned matrix corresponding to multiple <code>k</code> may not be orthogonal since we do not limit the input k list.</p><p><strong>kwargs</strong></p><pre><code class="nohighlight hljs"> dims::Int64/Tuple{Vararg{Int64}} = Tuple(1:D)</code></pre><p>The dimensions to perform the partial Fourier transform. For example, <code>dims = (1,)</code> means <code>k = (kₓ, y)</code> will give the coefficients <code>(x, y&#39;) -&gt; C e^{-ikₓx}δ(y - y&#39;)</code>, where <code>C</code> is a normalization constant. Note it will return <code>NaN</code> if any site in the lattice does not have the same y-coordinate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/FT/FTCoefs.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.FT" href="#FiniteLattices.FT"><code>FiniteLattices.FT</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> FT(Sr::AbstractMatrix,
      Latt::EmbeddedLattice{D},
      lsk::AbstractVector = _default_lsk(Latt);
      dims::Union{Int64, Tuple{Vararg{Int64}}} = Tuple(1:D)
      ) -&gt; FS::Matrix</code></pre><p>Finally used method, apply the Fourier transform <code>Sr(r, n) -&gt; FS(k, n)</code> where <code>n</code> is the column index of the given matrix <code>Sr</code>. </p><p>The FT convention please see <code>FTCoefs</code>.</p><pre><code class="nohighlight hljs"> FT(Sr::AbstractVector,
      Latt::EmbeddedLattice,
      lsk::AbstractVector = _default_lsk(Latt);
      kwargs...
      ) -&gt; ::Vector
 FT(Sr::AbstractMatrix,
      Latt::EmbeddedLattice{D},
      k::NTuple{D,Float64};
      kwargs...
      ) -&gt; ::Vector</code></pre><p>Return a vector for single <code>n</code> or <code>k</code>.</p><pre><code class="nohighlight hljs"> FT(Sr::AbstractVector,
      Latt::EmbeddedLattice{D},
      k::NTuple{D,Float64};
      kwargs...
      ) -&gt; ::ComplexF64</code></pre><p>Return the coefficients when both <code>n</code> and <code>k</code> are single.</p><pre><code class="nohighlight hljs"> FT(Latt::EmbeddedLattice, k; kwargs...) -&gt; f: Sr -&gt; FS</code></pre><p>Return the function instead of applying the FT immediately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/FT/FT.jl#L1-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FiniteLattices.FT2" href="#FiniteLattices.FT2"><code>FiniteLattices.FT2</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> FT2(SS::AbstractMatrix,
      Latt::EmbeddedLattice,
      k::Tuple;
      symmetric::Bool=true,
      dims::Union{Int64, Tuple{Vararg{Int64}}} = Tuple(1:D)
      ) -&gt; ::ComplexF64/Float64</code></pre><p>Apply twice Fourier transform with the same <code>k</code> to the input matrix <code>SS</code>. A common use case is to calculate the structure factor from the all to all correlation function. </p><p>If <code>symmetric = true</code>, we assume the input matrix is hermitian and thus the result should be real up to a numerical error. In this case, we will automatically complete the matrix if it is a upper/lower triangular matrix.</p><p><code>dims</code> gives the dimensions to perform the partial Fourier transform, details see function <code>FTCoefs</code>.</p><pre><code class="nohighlight hljs"> FF2(SS::AbstractMatrix,
      Latt::EmbeddedLattice,
      lsk::AbstractVector = _default_lsk(Latt);
      kwargs...) -&gt; ::Vector{ComplexF64/Float64}</code></pre><p>Return a vector by simply broadcasting <code>lsk</code>.</p><pre><code class="nohighlight hljs"> FT2(Latt::EmbeddedLattice, k) -&gt; f: SS -&gt; Sk</code></pre><p>Return the function instead of applying the FT immediately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Qiaoyi-Li/FiniteLattices.jl/blob/7bc55c5e5cfab783a19dd35a3235ddaefddee000/src/FT/FT2.jl#L1-L23">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 4 October 2025 07:42">Saturday 4 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
